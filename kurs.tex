\documentclass{bmstu}

\begin{document}

\makecourseworktitle
{} % Название факультета
{} % Название кафедры
{Моделирование построения поверхностных и объемных геометрий с помощью операции движения} % Тема работы
{} % Номер группы/ФИО студента (если авторов несколько, их необходимо разделить запятой)
{} % ФИО научного руководителя
{} % ФИО консультанта (необязательный аргумент; если консультантов несколько, их необходимо разделить запятой)

\maketableofcontents

\chapter*{ВВЕДЕНИЕ}
\addcontentsline{toc}{chapter}{ВВЕДЕНИЕ}
Для моделирование построения поверхностных и объемных геометрий необходимо использовать методы геометрического моделирования.

Поэтому, прежде, чем мы приступим к описанию построения геометрий с помощью операции движения, рассмотрим основные методы построения поверхностей и кривых, а именно  кривые и поверхности Безье, рациональные кривые и поверхности Безье и NURBS.


\chapter{Кривые и поверхности}
\section{Способы описания кривых и поверхностей}
Существует три основных подхода к описанию кривых и поверхностей.
\subsection{Явный вид}

Для кривой:
\begin{equation*}
    y=f(x), z = g(x)
\end{equation*}

Для поверхности:
\begin{equation*}
    z = f(x, y)
\end{equation*}

Этот метод имеет несколько недостатков:
\begin{itemize}
    \item Нельзя однозначно описать замкнутые кривые, например, окружности.
    \item Полученное описание не обладает инвариантностью относительно поворотов.
    \item При попытке задать кривые с очень большими углами наклона возникают большие вычислительные сложности.
\end{itemize}
\subsection{Неявные вид}

\begin{equation*}
    f(x,y,z) = 0
\end{equation*}

Недостатки:
\begin{itemize}
    \item Кривая в трёхмерном пространстве задаётся как пересечение двух поверхностей, т.е. требуется решать систему алгебраических уравнений.
    \item Сложности в процессе объединения неявно заданных фрагментов кривых
\end{itemize}

\subsection{Параметрический вид}

Параметрическое  задание кривой и поверхности преодолевает недостатки явного и неявного способов описания. С его помощью можно задавать многозначные кривые, т.е. такие зависимости, которые могут принимать несколько значений при одном значении аргумента.

Для кривой:
\begin{equation}
    \begin{cases}
        x = x(u) \\
        y = y(u) \\
        a \le u \le b
    \end{cases}
\end{equation}
и также будем пользоваться обозначением
\begin{equation}
    \mathbf{C}(u) = (x(u), y(u)),~        a \le u \le b
\end{equation}

Для поверхности:
\begin{equation}
    \begin{cases}
        x = x(u, v)   \\
        y = y(u, v)   \\
        z = z(u, v)   \\
        a \le u \le b \\
        c \le v \le d
    \end{cases}
\end{equation}
и также будем пользоваться обозначением

\begin{equation}
    \mathbf{S}(u, v) = (x(u, v), y(u, v), z(u, v)),~        a \le u \le b,~c \le v \le d
\end{equation}

\section{Кривые и поверхности Безье}

\subsection{Кривые Безье}

Пусть заданы $n+1$ точек $\mathbf{P}_i = (x_i,~y_i,~z_i)$, называемых контрольными точками. Они определяют форму и пространственное положение кривой.

Тогда кривую Безье n-ой степени можно задать с помощью уравнения:
\begin{equation}
    \mathbf{C}(u) = \sum\limits_{i=0}^n B_{i, n}(u)\mathbf{P}_i,~~~~ 0\le u\le 1б
\end{equation}
где $B_{i, n}$ - полиномы Бернштейна.
\begin{equation}
    B_{i, n}(u) = C^i_nu^i(1-u)^{n-i} = \frac{n!}{i!(n-i)!}u^i(1-u)^{n-i}
\end{equation}

Для вычисления точек кривой Безье удобно использовать алгоритм де Кастельжо:
\includelistingpretty
{deCasteljau.txt} % Имя файла с расширением (файл должен быть расположен в директории inc/lst/)
{c} % Язык программирования (необязательный аргумент)
{Псевдокод алгоритма де Кастельжо} % Подпись листинга

Например, на рисунке \ref{img:bez1} показана кривая Безье для контрольных точек $P_1 = (0,~0),~P_2=(0,~1),~P_3=(1,~2),~P_4=(3,~0)$.
\includeimage
{bez1} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Пример кривой Безье} % Подпись рисунка

\subsection{Поверхности Безье}

Пусть заданы контрольные точки $\mathbf{P}_{i,j}$, где $0 \le i \le n$ и $0 \le j \le m$.
Тогда поверхность Безье можно задать с помощью следующего уравнения:
\begin{equation}
    \mathbf{S}(u,v)=\sum\limits_{i=0}^n\sum\limits_{j=0}^m B_{i,n}(u)B_{j,m}(v)P_{i,j},~~~ 0\le u,v\le 1
\end{equation}
Аналогично кривым Безье, точки поверхности Безье можно находить с помощью алгоритма де Кастельжо из листинга \ref{lst:deCasteljau.txt}.
\includelistingpretty
{deCasteljau2.txt} % Имя файла с расширением (файл должен быть расположен в директории inc/lst/)
{c} % Язык программирования (необязательный аргумент)
{Псевдокод алгоритма де Кастельжо для поверхности} % Подпись листинга
На рисунке \ref{img:bez2} показан пример поверхности Безье для 15 контрольных точек.

\includeimage
{bez2} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Пример поверхности Безье} % Подпись рисунка

\section{Рациональные кривые и поверхности Безье}
\subsection{Рациональные кривые Безье}

Так как кривые Безье - полиномиальные кривые, они имеют существенный недостаток, а именно с их помощью невозможно задать некоторые виды кривых, такие как окружности, эллипсы, гиперболы и прочие. Данные виды кривых можно задать с помощью рациональных функций, то есть как частное двух полиномов.
\begin{equation}\label{rational_func}
    x(u) = \frac{X(u)}{W(u)}~~~~y(u) = \frac{Y(u)}{W(u)},
\end{equation}

где $X(u)$, $Y(u)$ и $W(u)$ - полиномы.

Заметим также, что каждая координатная функция имеет одинаковый знаменатель $W(u)$.

Рациональные кривые с координатными функциями в виде (\ref{rational_func}) имеют элегантную геометрическую интерпретацию, которая дает эффективные методы построения этих кривых и небольшие требования к памяти компьютера.

Оказывается, что можно использовать однородные координаты, чтобы задать рациональные кривые в $n$-мерном пространстве с помощью полиномиальной кривой в $(n+1)$-мерном пространстве.

Рассмотрим точку в евклидовом пространстве $\mathbf{P} = (x,y,z)$. Затем запишем точку $\mathbf{P}$ как $\mathbf{P^\omega}=(\omega x, \omega y, \omega z, \omega)=(X, Y, Z, W)$ в четырех-мерном пространстве, причем $\omega \neq 0$. Тогда $\mathbf{P}$ можно получить из $\mathbf{P^\omega}$ делением всех координат на четвертую координату $W$, то есть с помощью отображения $P^\omega$ на гиперплоскость $W=1$
\includeimage
{proj} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Представление точки евклидова пространства в однородной форме для двумерного случая} % Подпись рисунка

Данное отображение $H$ является перспективной проекцией с центром в начале координат:
\begin{equation}\label{projfunc}
    \mathbf{P} = H\{\mathbf{P^\omega}\} = H\{(X, Y, Z, W)\} =
    \left(\frac{X}{W}, \frac{Y}{W}, \frac{Z}{W}\right)
\end{equation}

Тогда для множества контрольных точек $\{\mathbf{P_i}\}$ и множества весов $\{\omega_i\}$ зададим множество взвешенных контрольных точек $\mathbf{P}_i^\omega=(\omega_ix_i,\omega_iy_i,\omega_iz_i, \omega_i)$. Тогда нерациональная (полиномиальная) кривая Безье в 4-х мерном пространстве
\begin{equation}\label{4bez}
    \mathbf{C}^\omega(u) = \sum\limits_{i=0}^nB_{i,n}(u)\mathbf{P}_i^\omega
\end{equation}

Уравнение (\ref{4bez}) в координатном виде:
\begin{equation*}
    X(u) = \sum\limits_{i=0}^nB_{i,n}(u)\omega_ix_i~~~~~~ Y(u) = \sum\limits_{i=0}^nB_{i,n}(u)\omega_iy_i
\end{equation*}
\begin{equation*}
    Z(u) = \sum\limits_{i=0}^nB_{i,n}(u)\omega_iz_i~~~~~~ W(u) = \sum\limits_{i=0}^nB_{i,n}(u)
\end{equation*}

Заметим, что $W \neq 0$ поскольку мы выбираем $\omega_i > 0$.

Применяя к (\ref{4bez}) отображение (\ref{projfunc}), получим искомую рациональную кривую Безье в 3-х мерном пространстве, задающуюся формулами
\[
    x(u) = \frac{X(u)}{W(u)}= \frac{\sum\limits_{i=0}^nB_{i,n}(u)\omega_ix_i}{\sum\limits_{i=0}^nB_{i,n}(u)\omega_i}
\]
\[
    y(u) = \frac{Y(u)}{W(u)}= \frac{\sum\limits_{i=0}^nB_{i,n}(u)\omega_iy_i}{\sum\limits_{i=0}^nB_{i,n}(u)\omega_i}
\]
\[
    z(u) = \frac{Z(u)}{W(u)}= \frac{\sum\limits_{i=0}^nB_{i,n}(u)\omega_iz_i}{\sum\limits_{i=0}^nB_{i,n}(u)\omega_i}
\]
или в векторной записи
\begin{equation}\label{ratcurve}
    \mathbf{C}(u) = \frac{\sum\limits_{i=0}^nB_{i,n}(u)\omega_i\mathbf{P}_i}{\sum\limits_{i=0}^nB_{i,n}(u)\omega_i}
\end{equation}



Например, если взять $\mathbf{P}_0 = (1,0)$, $\mathbf{P}_1 = (1,1)$, $\mathbf{P}_2 = (0,1)$ и $\omega_i = (1, 1, 2)$, получим дугу окружности(рисунок \ref{img:arc}).
\includeimage
{arc} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Дуга окружности, построенная с помощью рациональной кривой Безье} % Подпись рисунка

Если веса всех вершин равны, то получим обычную кривую Безье, поскольку в таком случае знаменатель в уравнение (\ref{ratcurve}) - это просто сумма полиномов Бернштейна, которая равна 1. Таким образом, рациональные кривые Безье являются обобщением полиномиальных кривых Безье.
\subsection{Рациональные поверхности Безье}

Аналогично рациональным кривым Безье, рациональные поверхности Безье можно представить как перспективную проекцию 4-х мерной полиномиальной поверхности Безье
\[
    \mathbf{S}^\omega(u, v) = \sum\limits_{i=0}^n\sum\limits_{j=0}^mB_{i,n}(u)B_{j,m}(v)\mathbf{P}^\omega_{i,j}
\]
\begin{multline}
    \mathbf{S}(u,v) = H\{\mathbf{S}^\omega(u, v)\} =  \frac{\sum\limits_{i=0}^n\sum\limits_{j=0}^mB_{i,n}(u)B_{j,m}(v)\omega_{i, j}\mathbf{P}_{i,j}}{\sum\limits_{i=0}^n\sum\limits_{j=0}^mB_{i,n}(u)B_{j,m}(v)\omega_{i, j}} =\\= \sum\limits_{i=0}^n\sum\limits_{j=0}^mR_{i,j}(u,v)\mathbf{P}_{i,j},
\end{multline}
где
\begin{equation}
    R_{i,j}(u, v) = \frac{B_{i, n}(u)B_{j, m}(v)}{\sum\limits_{r=0}^n\sum\limits_{s=0}^mB_{r,n}(u)B_{s,m}(v)\omega_{r, s}}
\end{equation}

На рисунке \ref{img:arcsur} изображена цилиндрическая поверхность, построенная с помощью рациональной поверхности Безье. Она представляет собой поверхность, полученную движением дуги окружности из рисунка \ref{img:arc}.
\includeimage
{arcsur} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
{f} % Обтекание (без обтекания)
{h} % Положение рисунка (см. figure из пакета float)
{0.5\textwidth} % Ширина рисунка
{Цилиндрическая поверхность, построенная с помощью рациональной поверхности Безье} % Подпись рисунка


\end{document}